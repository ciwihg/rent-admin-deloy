(function(e){function t(t){for(var i,o,s=t[0],l=t[1],c=t[2],d=0,m=[];d<s.length;d++)o=s[d],r[o]&&m.push(r[o][0]),r[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);u&&u(t);while(m.length)m.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],i=!0,s=1;s<a.length;s++){var l=a[s];0!==r[l]&&(i=!1)}i&&(n.splice(t--,1),e=o(o.s=a[0]))}return e}var i={},r={app:0},n=[];function o(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=i,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(a,i,function(t){return e[t]}.bind(null,i));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/rent-admin-deloy/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var i=a("64a9"),r=a.n(i);r.a},"03ab":function(e,t,a){},"0981":function(e,t,a){"use strict";var i=a("fe89"),r=a.n(i);r.a},"1dc1":function(e,t,a){},"231c":function(e,t,a){"use strict";var i=a("cd04"),r=a.n(i);r.a},"237f":function(e,t,a){},"2afd":function(e,t,a){},"2c3e":function(e,t,a){},"2fe6":function(e,t,a){},"36f0":function(e,t,a){},"3c9c":function(e,t,a){},"3f94":function(e,t,a){"use strict";var i=a("d89c"),r=a.n(i);r.a},"424e":function(e,t,a){},"4c70":function(e,t,a){},"51bb":function(e,t,a){},"53cc":function(e,t,a){"use strict";var i=a("2afd"),r=a.n(i);r.a},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("f751"),a("097d");var i,r=a("2b0e"),n=a("5c96"),o=a.n(n),s=(a("0fae"),a("8c4f")),l=a("2f62"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"},on:{click:e.handleNavmenu}},[a("div",{staticStyle:{width:"100%",height:"50px","background-color":"#545c64",display:"flex","align-items":"center",color:"white"}},[a("i",{staticClass:"el-icon-menu",staticStyle:{padding:"0px 20px","font-size":"24px"},on:{click:e.handleSwitch}}),a("div",{staticStyle:{"flex-grow":"1","text-align":"center"}},[e._v(e._s(e.pagetitle))])]),a("transition",{attrs:{name:"el-zoom-in-top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isCollapse,expression:"isCollapse"}],staticStyle:{width:"200px",position:"absolute",left:"0",top:"50px","z-index":"10"},on:{click:e.stopbubble}},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"2","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",router:!0,width:"200px"},on:{select:e.handleSelect}},[a("el-menu-item",{attrs:{index:"/datacenter"}},[a("i",{staticClass:"el-icon-menu"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("数据中心")])]),a("el-menu-item",{attrs:{index:"/hi"}},[a("i",{staticClass:"el-icon-setting"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("租盘管理")])]),a("el-menu-item",{attrs:{index:"/chargeitems"}},[a("i",{staticClass:"el-icon-menu"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("收费管理")])]),a("el-menu-item",{attrs:{index:"/checkout"}},[a("i",{staticClass:"el-icon-menu"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("抄表及打印")])])],1)],1)]),a("router-view")],1)},u=[],d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"hello"},[a("div",{staticClass:"houses-head-wrap"},[a("el-button",{attrs:{type:"primary",size:"small",round:""},on:{click:e.handleToAdd}},[e._v("添加")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{fixed:"",prop:"number",label:"房号",width:"80px"}}),a("el-table-column",{attrs:{prop:"type",label:"户型",width:"min-width"}}),a("el-table-column",{attrs:{prop:"address",label:"地址",filters:[{text:"横潭大街32号",value:"横潭大街32号"},{text:"朝阳巷5号",value:"朝阳巷5号"},{text:"横潭市场",value:"横潭市场"}],"filter-method":e.filterHandler,width:"min-width"}}),a("el-table-column",{attrs:{fixed:"right",width:"50px",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleNmenuClick}},[a("i",{staticClass:"el-icon-more"}),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:{house:t.row,action:"records"}}},[e._v("水电表记录")]),a("el-dropdown-item",{attrs:{command:{house:t.row,action:"history"}}},[e._v("出租历史")]),a("el-dropdown-item",{attrs:{command:{house:t.row,action:"edit"}}},[e._v("编辑")]),a("el-dropdown-item",{attrs:{command:{house:t.row,action:"delete"}}},[e._v("删除")])],1)],1)]}}])})],1)],1)},m=[],h=a("0a0d"),f=a.n(h),p=(a("ac6a"),a("a4bb")),b=a.n(p),v=(a("4917"),a("a481"),{formatPrice:function(e){return e.replace(/^(\d+)($|\.\d+)/,function(e,t,a){return""===a?e+".00":t+(a+="00").match(/^\.\d{2}/)[0]})},Object2Array:function(e,t){var a=this;return b()(e).map(function(i){return e[i].id=i,e[i].date&&(e[i].dateformate=a.getDate(e[i].date)),t&&(e[i].parentid=t),e[i]})},getDate:function(e){var t=new Date(e),a=("0"+(t.getMonth()+1)).match(/.*(\d{2})$/)[1],i=("0"+t.getDate()).match(/.*(\d{2})$/)[1];return t.getFullYear()+"-"+a+"-"+i},quicksort:function(e){function t(e,a,i){if(!(a>=i)){e[a];var r,n=e[a].date,o=a,s=i;while(a<i){while(e[a].date<n)a+=1;while(e[i].date>n)i-=1;a<i&&(r=e[a],e[a]=e[i],e[i]=r)}t(e,o,a-1),t(e,a+1,s)}}t(e,0,e.length-1)},writeCookie:function(e,t){},parseCookie:function(){var e=document.cookie.match(/[^;]+(;|$)/g),t={};return e&&e.forEach(function(e){var a=e.match(/([^\s]+)=([^;]*)/);console.log(a),t[a[1]]=a[2]}),t}}),w=v,g={name:"HelloWorld",data:function(){return{inputdata:"",tableData:[],pagetitle:"租盘管理"}},props:{msg:String},beforeRouteEnter:function(e,t,a){a(function(e){e.$store.commit("settitle",e.pagetitle)})},created:function(){var e=f()(),t=this;window.firebase.database().ref("houses").on("value",function(a){t.tableData=w.Object2Array(a.val()),console.log(f()()-e)})},methods:{handleClick:function(){var e=this.tableData?this.tableData.map(function(e){return e}):[];e.push({number:this.inputdata,type:"一房一厅",address:"横潭大街32-1号"}),window.firebase.database().ref("test").set(e)},handleDelect:function(e){var t=this;this.$confirm("删除 ".concat(e.number,"-").concat(e.type,"-").concat(e.address," 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){window.firebase.database().ref("houses/"+e.id).remove(),t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleEdit:function(e){this.$router.push({path:"/edithouse/"+e.id})},handleToAdd:function(){this.$router.push({path:"/add"})},handleNmenuClick:function(e){switch(e.action){case"records":this.$store.commit("sethouse",e.house),this.$store.commit("setwatermonitors",e.house.watermonitors),this.$store.commit("seteletricmonitors",e.house.eletricmonitors),this.$router.push({path:"/managerecord"});break;case"history":this.$router.push({path:"/history"}),this.$store.commit("sethouse",e.house);break;case"edit":this.handleEdit(e.house);break;case"delete":this.handleDelect(e.house);break}},filterHandler:function(e,t){return t.address===e}}},y=g,k=(a("0981"),a("2877")),$=Object(k["a"])(y,d,m,!1,null,"31f55d18",null),x=$.exports,_={name:"app",components:{HelloWorld:x},data:function(){return{isCollapse:!0}},computed:{pagetitle:function(){return this.$store.state.title}},created:function(){window.loading.close()},methods:{handleSelect:function(){},handleNavmenu:function(e){this.isCollapse=!1},stopbubble:function(e){e.stopPropagation()},handleSwitch:function(e){e.stopPropagation(),this.isCollapse=!this.isCollapse}}},L=_,Q=(a("034f"),Object(k["a"])(L,c,u,!1,null,null,null)),C=Q.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-from-wrap"},[a("el-form",{attrs:{"label-width":"70px",model:e.house,"label-position":"top"}},[a("el-form-item",{attrs:{label:"房号"}},[a("el-input",{model:{value:e.house.number,callback:function(t){e.$set(e.house,"number",t)},expression:"house.number"}})],1),a("el-form-item",{attrs:{label:"户型"}},[a("el-input",{model:{value:e.house.type,callback:function(t){e.$set(e.house,"type",t)},expression:"house.type"}})],1),a("el-form-item",{attrs:{label:"地址"}},[a("el-input",{model:{value:e.house.address,callback:function(t){e.$set(e.house,"address",t)},expression:"house.address"}})],1),a("el-form-item",{attrs:{label:"租金"}},[a("el-input",{model:{value:e.house.price,callback:function(t){e.$set(e.house,"price",t)},expression:"house.price"}})],1),a("el-form-item",{attrs:{label:"押金"}},[a("el-input",{model:{value:e.house.subprice,callback:function(t){e.$set(e.house,"subprice",t)},expression:"house.subprice"}})],1),a("el-form-item",{attrs:{label:"是否收取电费"}},[a("el-switch",{attrs:{"active-text":"收取","inactive-text":"不收取"},model:{value:e.house.eletric,callback:function(t){e.$set(e.house,"eletric",t)},expression:"house.eletric"}})],1),a("el-form-item",{attrs:{label:"是否收取水费"}},[a("el-switch",{attrs:{"active-text":"收取","inactive-text":"不收取"},model:{value:e.house.water,callback:function(t){e.$set(e.house,"water",t)},expression:"house.water"}})],1),a("el-form-item",{attrs:{label:"收费项目"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.house.chargeitems,callback:function(t){e.$set(e.house,"chargeitems",t)},expression:"house.chargeitems"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",round:""},on:{click:e.handleAdd}},[e._v("保存")])],1)],1)},D=[],S=(a("7f7f"),{name:"Addform",data:function(){return{inputdata:"addpage",options:[],house:{number:"",type:"",address:"",price:"",subprice:"",chargeitems:[],eletric:!1,water:!1},pagetitle:"新增租盘"}},beforeRouteEnter:function(e,t,a){a(function(e){e.$store.commit("settitle",e.pagetitle)})},props:{msg:String},created:function(){var e=this;window.firebase.database().ref("chargeitems").once("value",function(t){var a=[];for(var i in t.val())"universal"==t.val()[i]["type"]&&a.push({label:t.val()[i]["name"],value:i});e.options=a,console.log(a)})},methods:{handleAdd:function(){var e=this,t=window.firebase.database().ref("houses").push();t.set(this.house).then(function(){e.$confirm("是否立即为该房源初始化水电表数值?","提示",{confirmButtonText:"立即初始化",cancelButtonText:"稍后再初始化",type:"warning"}).then(function(){e.$router.push({path:"/initrecord/"+t.key})}).catch(function(){e.$router.push({path:"/hi"})})}).catch(function(){console.log("write failed")})}}}),O=S,A=(a("b31d"),Object(k["a"])(O,E,D,!1,null,"5a56a408",null)),R=A.exports,j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"houses-head-wrap"},[a("el-button",{attrs:{type:"primary",size:"small",round:""},on:{click:e.handleToAdd}},[e._v("添加")])],1),a("div",{staticClass:"title-wrap"},[e._v("其他费用")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.universal,stripe:""}},[a("el-table-column",{attrs:{fixed:"",prop:"name",label:"项目",width:"80px"}}),a("el-table-column",{attrs:{prop:"price",label:"价格(单位:元)",width:"min-width"}}),a("el-table-column",{attrs:{fixed:"right",width:"150px",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelect(t.row)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"title-wrap"},[e._v("水电费")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.usage,stripe:""}},[a("el-table-column",{attrs:{fixed:"",prop:"name",label:"项目",width:"80px"}}),a("el-table-column",{attrs:{prop:"price",label:"价格(单位:元)",width:"min-width"}}),a("el-table-column",{attrs:{fixed:"right",width:"150px",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelect(t.row)}}},[e._v("删除")])]}}])})],1)],1)},T=[],z={name:"chargeitems",data:function(){return{universal:[],usage:[],pagetitle:"收费管理"}},beforeRouteEnter:function(e,t,a){a(function(e){e.$store.commit("settitle",e.pagetitle)})},created:function(){var e=this,t={universal:"",water:"",eletric:""};window.firebase.database().ref("chargeitems").on("value",function(a){for(var i in t.universal=e.universal=[],t.eletric=t.water=e.usage=[],a.val())t[a.val()[i]["type"]].push({id:i,name:a.val()[i]["name"],price:"".concat(w.formatPrice(a.val()[i]["price"]),"/").concat(a.val()[i]["unit"])})})},methods:{handleEdit:function(e){this.$router.push({path:"/editchargeitem/"+e.id})},handleDelect:function(e){var t=this;this.$confirm("删除"+e.name+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){window.firebase.database().ref("chargeitems/"+e.id).remove(),t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleToAdd:function(){this.$router.push({path:"/addchargeitem"})}}},M=z,N=(a("873d"),Object(k["a"])(M,j,T,!1,null,"cb566b42",null)),P=N.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-from-wrap"},[a("el-form",{attrs:{"label-width":"70px",model:e.formdata,"label-position":"left"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:e.formdata.name,callback:function(t){e.$set(e.formdata,"name",t)},expression:"formdata.name"}})],1),a("el-form-item",{attrs:{label:"价格"}},[a("el-input",{model:{value:e.formdata.price,callback:function(t){e.$set(e.formdata,"price",t)},expression:"formdata.price"}})],1),a("el-form-item",{attrs:{label:"收费类型"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formdata.type,callback:function(t){e.$set(e.formdata,"type",t)},expression:"formdata.type"}},e._l(e.options,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1)],1),a("el-button",{attrs:{type:"primary",round:"",disabled:e.saveavaliable},on:{click:e.handleAdd}},[e._v("保存")])],1)},q=[],Z={name:"Addchargeitem",data:function(){return{options:[{label:"其他费用",value:"universal"},{label:"水费",value:"water"},{label:"电费",value:"eletric"}],units:[{label:"KWH",vaule:"KWH"},{label:"m³",value:"m³"}],formdata:{name:"",price:"",type:"",unit:""},pagetitle:"新增收费项目"}},beforeRouteEnter:function(e,t,a){a(function(e){e.$store.commit("settitle",e.pagetitle)})},computed:{saveavaliable:function(){return""===this.formdata.name||""===this.formdata.price},unit:function(){var e={universal:"月",water:"m³",eletric:"KWH"};return e[this.formdata.type]}},methods:{handleAdd:function(){var e=this,t=window.firebase.database().ref("chargeitems").push();this.formdata.unit=this.unit,t.set(this.formdata).then(function(){e.$router.push({path:"/chargeitems"})}).catch(function(){console.log("write failed")})},handleChange:function(e){this.formdata.unit=e?"月":""}}},U=Z,H=(a("231c"),Object(k["a"])(U,B,q,!1,null,"231770f6",null)),I=H.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-from-wrap"},[a("el-form",{attrs:{"label-width":"70px",model:e.formdata,"label-position":"left"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:e.formdata.name,callback:function(t){e.$set(e.formdata,"name",t)},expression:"formdata.name"}})],1),a("el-form-item",{attrs:{label:"价格"}},[a("el-input",{model:{value:e.formdata.price,callback:function(t){e.$set(e.formdata,"price",t)},expression:"formdata.price"}})],1),a("el-form-item",{attrs:{label:"收费类型"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.formdata.type,callback:function(t){e.$set(e.formdata,"type",t)},expression:"formdata.type"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),a("el-button",{attrs:{type:"primary",round:"",disabled:e.saveavaliable},on:{click:e.handleSave}},[e._v("保存")])],1)},W=[],F={name:"Editchargeitem",data:function(){return{options:[{label:"其他费用",value:"universal"},{label:"水费",value:"water"},{label:"电费",value:"eletric"}],units:[{label:"KWH",value:"KWH"},{label:"m³",value:"m³"}],formdata:{name:"",price:"",type:"",unit:""},pagetitle:"修改收费项目"}},beforeRouteEnter:function(e,t,a){a(function(e){e.$store.commit("settitle",e.pagetitle)})},computed:{saveavaliable:function(){return""===this.formdata.name||""===this.formdata.price},unit:function(){var e={universal:"月",water:"m³",eletric:"KWH"};return e[this.formdata.type]}},created:function(){var e=this;window.firebase.database().ref("chargeitems/"+this.$route.params.id).once("value",function(t){e.formdata=t.val()})},methods:{handleSave:function(){var e=this,t=this;this.formdata.unit=this.unit,window.firebase.database().ref("chargeitems/"+this.$route.params.id).set(t.formdata).then(function(){e.$router.push("/chargeitems")}).catch(function(){console.log("write failed")})},handleChange:function(e){this.formdata.unit=e?"月":""}}},K=F,J=(a("3f94"),Object(k["a"])(K,G,W,!1,null,"0d685545",null)),Y=J.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-from-wrap"},[a("el-form",{attrs:{"label-width":"70px",model:e.house,"label-position":"top"}},[a("el-form-item",{attrs:{label:"房号"}},[a("el-input",{model:{value:e.house.number,callback:function(t){e.$set(e.house,"number",t)},expression:"house.number"}})],1),a("el-form-item",{attrs:{label:"户型"}},[a("el-input",{model:{value:e.house.type,callback:function(t){e.$set(e.house,"type",t)},expression:"house.type"}})],1),a("el-form-item",{attrs:{label:"地址"}},[a("el-input",{model:{value:e.house.address,callback:function(t){e.$set(e.house,"address",t)},expression:"house.address"}})],1),a("el-form-item",{attrs:{label:"租金"}},[a("el-input",{model:{value:e.house.price,callback:function(t){e.$set(e.house,"price",t)},expression:"house.price"}})],1),a("el-form-item",{attrs:{label:"押金"}},[a("el-input",{model:{value:e.house.subprice,callback:function(t){e.$set(e.house,"subprice",t)},expression:"house.subprice"}})],1),a("el-form-item",{attrs:{label:"是否收取电费"}},[a("el-switch",{attrs:{"active-text":"收取","inactive-text":"不收取"},model:{value:e.house.eletric,callback:function(t){e.$set(e.house,"eletric",t)},expression:"house.eletric"}})],1),a("el-form-item",{attrs:{label:"是否收取水费"}},[a("el-switch",{attrs:{"active-text":"收取","inactive-text":"不收取"},model:{value:e.house.water,callback:function(t){e.$set(e.house,"water",t)},expression:"house.water"}})],1),a("el-form-item",{attrs:{label:"收费项目"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.house.chargeitems,callback:function(t){e.$set(e.house,"chargeitems",t)},expression:"house.chargeitems"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",round:""},on:{click:e.handleSave}},[e._v("保存")])],1)],1)},X=[],ee={name:"edithouse",data:function(){return{pagetitle:"修改租盘",inputdata:"addpage",options:[],house:{number:"",type:"",address:"",price:"",subprice:"",chargeitems:[],eletric:!1,water:!1}}},props:{msg:String},beforeRouteEnter:function(e,t,a){a(function(e){e.$store.commit("settitle",e.pagetitle)})},created:function(){var e=this;window.firebase.database().ref("houses/"+this.$route.params.id).once("value",function(t){e.house=t.val()}),window.firebase.database().ref("chargeitems").once("value",function(t){var a=[];for(var i in t.val())"universal"==t.val()[i].type&&a.push({label:t.val()[i]["name"],value:i});e.options=a})},methods:{handleSave:function(){window.firebase.database().ref("houses/"+this.$route.params.id).set(this.house),this.$router.push({path:"/hi"})}}},te=ee,ae=(a("6829"),Object(k["a"])(te,V,X,!1,null,"40fbec5d",null)),ie=ae.exports,re=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-wrap"},[a("el-form",{attrs:{model:e.formdata,"label-width":"80px"}},[e.house.eletric?a("div",[a("div",{staticClass:"button-wrap"},[a("el-button",{attrs:{type:"primary",round:""},on:{click:e.handleAdde}},[e._v("增加电表")])],1),a("div",e._l(e.formdata.eletrics,function(t,i){return a("div",{staticClass:"row-wrap"},[a("el-form-item",{attrs:{label:"电表"+i+"数值"}},[a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1),a("el-form-item",{attrs:{label:"计量单价"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.unitprice,callback:function(a){e.$set(t,"unitprice",a)},expression:"item.unitprice"}},e._l(e.eletricoptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),a("el-button",{staticClass:"minus-button",staticStyle:{"margin-left":"15px"},attrs:{type:"primary",icon:"el-icon-minus",circle:""},on:{click:e.delete1eletric}})],1)],1)}),0)]):e._e(),e.house.water?a("div",[a("div",{staticClass:"button-wrap"},[a("el-button",{attrs:{type:"primary",round:""},on:{click:e.handleAddw}},[e._v("增加水表")])],1),a("div",e._l(e.formdata.waters,function(t,i){return a("div",{staticClass:"subrow-wrap"},[a("el-form-item",{attrs:{label:"水表"+i+"数值"}},[a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1),a("el-form-item",{attrs:{label:"计量单价"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.unitprice,callback:function(a){e.$set(t,"unitprice",a)},expression:"item.unitprice"}},e._l(e.wateroptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),a("el-button",{staticClass:"minus-button",staticStyle:{"margin-left":"15px"},attrs:{type:"primary",icon:"el-icon-minus",circle:""},on:{click:e.delete1water}})],1)],1)}),0)]):e._e(),a("div",{staticClass:"button-wrap"},[a("el-button",{attrs:{round:""},on:{click:e.handleAddw}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",round:""},on:{click:e.handleInit}},[e._v("立即初始化")])],1)])],1)},ne=[],oe={name:"Initrecord",data:function(){return{formdata:{eletrics:[{value:"0",unitprice:""}],waters:[{value:"0",unitprice:""}]},wateroptions:[],eletricoptions:[],tables:{water:"waterfees",eletric:"eletricfees"},house:{}}},beforeRouteEnter:function(e,t,a){a()},created:function(){var e=this;window.firebase.database().ref("chargeitems").once("value").then(function(t){for(var a in t.val())"water"==t.val()[a].type&&e.wateroptions.push({id:a,name:t.val()[a].name}),"eletric"==t.val()[a].type&&e.eletricoptions.push({id:a,name:t.val()[a].name})}).then(function(){window.firebase.database().ref("houses/"+e.$route.params.id).once("value",function(t){e.house=t.val()})})},methods:{handleAdde:function(){this.formdata.eletrics.push({value:"0"})},handleAddw:function(){this.formdata.waters.push({value:"0"})},delete1eletric:function(e){this.formdata.eletrics.pop()},delete1water:function(e){this.formdata.waters.pop()},handleInit:function(){this.house.eletric&&this.processRecord("eletric"),this.house.water&&this.processRecord("water")},processRecord:function(e){var t={water:{monitors:this.formdata.waters,tablename:"watermonitors"},eletric:{monitors:this.formdata.eletrics,tablename:"eletricmonitors"}},a=t[e].monitors.map(function(a,i){var r=window.firebase.database().ref(t[e].tablename).push();return r.set({name:i,priceid:a.unitprice}).then(function(){var i=window.firebase.database().ref(t[e].tablename+"/"+r.key+"/records").push();i.set({value:a.value,date:f()()})}),r.key});window.firebase.database().ref("houses/"+this.$route.params.id+"/"+t[e].tablename).set(a)}}},se=oe,le=(a("664a"),Object(k["a"])(se,re,ne,!1,null,"66c279b6",null)),ce=le.exports,ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"houses-head-wrap"},[a("el-button",{attrs:{type:"primary",size:"small",round:""},on:{click:e.handleToAdd}},[e._v("添加")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{fixed:"",prop:"name",label:"名称",width:"80px"}}),a("el-table-column",{attrs:{prop:"price",label:"单价",width:"min-width"}}),a("el-table-column",{attrs:{fixed:"right",width:"150px",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelect(t.row)}}},[e._v("删除")])]}}])})],1)],1)},de=[],me={name:"",data:function(){return{tableData:[],tables:{water:"waterfees",eletric:"eletricfees"},table:""}},beforeRouteEnter:function(e,t,a){a(function(t){t.table=t.tables[e.path.match(/\/(.+)/)[1]],window.firebase.database().ref(t.table).on("value",function(e){t.tableData=w.Object2Array(e.val())})})},methods:{handleEdit:function(e){this.$router.push({path:"/editfee/"+e.id})},handleDelect:function(e){var t=this;this.$confirm("删除 ".concat(e.name," 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){window.firebase.database().ref(t.table+"/"+e.id).remove(),t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleToAdd:function(){this.$router.push({path:"/addfee"})}}},he=me,fe=(a("8ee3"),Object(k["a"])(he,ue,de,!1,null,"a2494708",null)),pe=fe.exports,be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-from-wrap"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{fixed:"",prop:"number",label:"ITEM NO."}}),a("el-table-column",{attrs:{fixed:"",prop:"name",label:"PRODUCT NAME"}}),a("el-table-column",{attrs:{fixed:"",prop:"color",label:"COLOR"}}),a("el-table-column",{attrs:{fixed:"",prop:"size",label:"SIZE"}}),a("el-table-column",{attrs:{fixed:"",prop:"unit",label:"UNIT"}}),a("el-table-column",{attrs:{fixed:"",prop:"qty",label:"QTY"}})],1)],1)},ve=[],we=a("bd86"),ge=(i={name:"Addfee",data:function(){return{formdata:{name:"",price:""},table:{water:"waterfees",eletric:"eletricfees"},path:"",pagetitle:"新增收费项目",tableData:[{number:"1",name:"GRUEN 468pcs 5mm stones",color:"Crystal",size:"5mm stones",unit:"pc",qty:"31"},{number:"2",name:"Pearl 425pcs 5mm stones",color:"Pearl",size:"5mm stones",unit:"pc",qty:"67"},{number:"3",name:"GRUEN 468pcs 5mm stones",color:"Turquoise",size:"5mm stones",unit:"pc",qty:"20"},{number:"4",name:"GRUEN 468pcs 5mm stones",color:"Pink",size:"5mm stones",unit:"pc",qty:"24"},{number:"5",name:"GRUEN 468pcs 5mm stones",color:"Blue",size:"5mm stones",unit:"pc",qty:"28"},{number:"6",name:"GRUEN 468pcs 5mm stones",color:"Red",size:"5mm stones",unit:"pc",qty:"46"},{number:"7",name:"GRUEN 468pcs 5mm stones",color:"Champagne",size:"5mm stones",unit:"pc",qty:"30"},{number:"8",name:"775pcs 3mm stones",color:"Crystal",size:"3mm stones",unit:"pc",qty:"36"},{number:"9",name:"GRUEN 468pcs 5mm stones",color:"Jelly white",size:"5mm stones",unit:"pc",qty:"61"},{number:"10",name:"GRUEN 468pcs 5mm stones",color:"Black",size:"5mm stones",unit:"pc",qty:"15"}]}},beforeRouteEnter:function(e,t,a){a(function(e){e.$store.commit("settitle",e.pagetitle)})}},Object(we["a"])(i,"beforeRouteEnter",function(e,t,a){a(function(e){e.path=t.path,e.table=e.table[e.path.match(/\/(.+)/)[1]],console.log(e.table)})}),Object(we["a"])(i,"methods",{handleAdd:function(){var e=this,t=window.firebase.database().ref(this.table).push();t.set(this.formdata).then(function(){e.$router.push({path:e.path})}).catch(function(){console.log("write failed")})}}),i),ye=ge,ke=(a("5c2e"),Object(k["a"])(ye,be,ve,!1,null,"5b4c0758",null)),$e=ke.exports,xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-from-wrap"},[a("el-form",{attrs:{"label-width":"70px",model:e.formdata,"label-position":"left"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:e.formdata.name,callback:function(t){e.$set(e.formdata,"name",t)},expression:"formdata.name"}})],1),a("el-form-item",{attrs:{label:"单价"}},[a("el-input",{model:{value:e.formdata.price,callback:function(t){e.$set(e.formdata,"price",t)},expression:"formdata.price"}})],1)],1),a("el-button",{attrs:{type:"primary",round:""},on:{click:e.handleSave}},[e._v("保存")])],1)},_e=[],Le={name:"Editfee",data:function(){return{formdata:{name:"",price:""},tables:{water:"waterfees",eletric:"eletricfees"},table:"",path:""}},beforeRouteEnter:function(e,t,a){a(function(a){a.path=t.path,a.table=a.tables[t.path.match(/\/(.+)/)[1]],window.firebase.database().ref(a.table+"/"+e.params.id).once("value",function(e){a.formdata=e.val()})})},created:function(){},methods:{handleSave:function(){var e=this;window.firebase.database().ref(this.table+"/"+this.$route.params.id).set(this.formdata).then(function(){e.$router.push(e.path)}).catch(function(){console.log("write failed")})}}},Qe=Le,Ce=(a("d752"),Object(k["a"])(Qe,xe,_e,!1,null,"2b04b972",null)),Ee=Ce.exports,De=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Mnavbar",{attrs:{itemdata:e.navdata},on:{select:e.handleSwitch}}),e.autopage?e._e():a("div",[a("div",{staticClass:"search-input",staticStyle:{display:"flex","justify-content":"center"}},[a("div",[a("el-input",{attrs:{placeholder:"请输入房号"},model:{value:e.filternum,callback:function(t){e.filternum=t},expression:"filternum"}})],1),a("div",[a("el-select",{attrs:{placeholder:"请选择地址"},model:{value:e.filteraddr,callback:function(t){e.filteraddr=t},expression:"filteraddr"}},e._l(e.addroptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)]),a("div",{staticClass:"search-btn"},[a("el-button",{attrs:{size:"small",round:"",type:"primary"},on:{click:e.handleFind}},[e._v("查找")]),a("el-button",{attrs:{size:"small",round:"",type:"primary"},on:{click:e.handleReset}},[e._v("重置")])],1)]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""},on:{"row-click":e.handleRowclick}},[a("el-table-column",{attrs:{prop:"number",label:"房号",width:"80"}}),a("el-table-column",{attrs:{prop:"address",label:"地址",width:"min-width"}}),a("el-table-column",{attrs:{prop:"date",label:"起租日",width:"100"}})],1)],1)},Se=[],Oe=(a("6762"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",{staticClass:"nav-bar",on:{click:e.handleItemclick}},[a("li",{class:{"item-on":e.items.i1},attrs:{mkey:"i1",iaction:e.itemdata[0].key}},[e._v(e._s(e.itemdata[0].label))]),a("li",{class:{"item-on":e.items.i2},attrs:{mkey:"i2",iaction:e.itemdata[1].key}},[e._v(e._s(e.itemdata[1].label))])])}),Ae=[],Re={name:"Mnavbar",props:["itemdata"],data:function(){return{items:{i1:!0,i2:!1},active:"i1"}},methods:{handleItemclick:function(e){console.log(this.itemdata),""!=this.active&&(this.items[this.active]=!1),this.items[e.target.getAttribute("mkey")]=!0,this.active=e.target.getAttribute("mkey"),this.$emit("select",e.target.getAttribute("iaction"))}}},je=Re,Te=(a("ac6e"),Object(k["a"])(je,Oe,Ae,!1,null,"5de23dbf",null)),ze=Te.exports,Me={name:"Checkout",components:{Mnavbar:ze},data:function(){return{autopage:!0,addroptions:[{label:"横潭大街32号",value:"横潭大街32号"},{label:"朝阳巷5号",value:"朝阳巷5号"},{label:"横潭市场",value:"横潭市场"}],filteraddr:"",filternum:"",navdata:[{label:"自动推荐",key:"auto"},{label:"自定义查找",key:"search"}],tableData:[],allData:[],autoData:[],filterData:[],pagetitle:"抄表及打印"}},beforeRouteEnter:function(e,t,a){a(function(e){e.$store.commit("settitle",e.pagetitle)})},created:function(){var e=this;window.firebase.database().ref("houses").once("value",function(t){t.forEach(function(t){var a=t.val();a.rentdate&&(a.id=t.key,a.rentdate&&(a.date=w.getDate(a.rentdate)),e.allData.push(a))}),e.tableData=e.autoData=e.filterDate(e.allData,3),console.log(e.tableData)})},methods:{handleRowclick:function(e){this.$router.push({path:"/generatebill/"+e.id})},filterDate:function(e,t){for(var a=864e5,i=[],r=-t;r<=t;r++){var n=new Date(f()()+r*a);i.push(n.getDate())}return e.filter(function(e){var t=new Date(e.rentdate);return i.includes(t.getDate())})},handleSwitch:function(e){"auto"==e?(this.autopage=!0,this.tableData=this.autoData):(this.autopage=!1,this.tableData=[])},handleReset:function(){this.tableData=[]},handleFind:function(){var e=this;this.tableData=this.allData.filter(function(t){return t.number==e.filternum&&t.address==e.filteraddr})}}},Ne=Me,Pe=(a("b23b"),Object(k["a"])(Ne,De,Se,!1,null,"4bf58171",null)),Be=Pe.exports,qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Mnavbar",{attrs:{itemdata:e.navdata},on:{select:e.handleSelect}}),e.history?a("div",[a("div",{staticClass:"history-select"},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.handlebillselect},model:{value:e.historybill,callback:function(t){e.historybill=t},expression:"historybill"}},e._l(e.historybills,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:t}})}),1)],1),e.billon?a("Mbill",{attrs:{initdata:e.historydata}}):e._e()],1):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.addnew,expression:"addnew"}]},[a("el-form",{attrs:{"label-width":"70px",model:e.house,"label-position":"left"}},[e._l(e.eletricmonitors,function(t,i){return a("div",{directives:[{name:"show",rawName:"v-show",value:e.house.eletric,expression:"house.eletric"}]},[a("h4",{staticClass:"info-title"},[e._v(e._s("电表"+t.name))]),a("div",{staticClass:"info-wrap"},[a("div",{staticClass:"last-record-row"},[e._v(e._s("末次记录 "+t.lastrecord+"   "+t.lastdate))]),a("el-form-item",{attrs:{label:"本次记录"}},[a("el-input",{on:{change:e.handleChange},model:{value:t.current,callback:function(a){e.$set(t,"current",a)},expression:"item.current"}})],1)],1)])}),e._l(e.watermonitors,function(t,i){return a("div",{directives:[{name:"show",rawName:"v-show",value:e.house.water,expression:"house.water"}]},[a("h4",{staticClass:"info-title"},[e._v(e._s("水表"+t.name))]),a("div",{staticClass:"info-wrap"},[a("div",{staticClass:"last-record-row"},[e._v(e._s("末次记录 "+t.lastrecord+"   "+t.lastdate))]),a("el-form-item",{attrs:{label:"本次记录"}},[a("el-input",{on:{change:e.handleChange},model:{value:t.current,callback:function(a){e.$set(t,"current",a)},expression:"item.current"}})],1)],1)])})],2),a("div",{staticClass:"generate-wrap"},[a("el-button",{attrs:{type:"primary",round:""},on:{click:e.generate}},[e._v("生成账单")])],1),e.billon?a("Mbill",{attrs:{initdata:e.historydata}}):e._e()],1)],1)},Ze=[],Ue=(a("5df3"),a("795b")),He=a.n(Ue),Ie=a("59ad"),Ge=a.n(Ie),We=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("h5",{staticClass:"bill-title"},[e._v("电费")]),e._l(e.billdata.eletric,function(e,t){return a("el-table",{attrs:{data:e}},[a("el-table-column",{attrs:{prop:"current",label:"本次记录"}}),a("el-table-column",{attrs:{prop:"lastrecord",label:"末次记录"}}),a("el-table-column",{attrs:{prop:"usage",label:"度差"}}),a("el-table-column",{attrs:{prop:"price",label:"单价"}}),a("el-table-column",{attrs:{prop:"total",label:"价格"}})],1)})],2),a("div",[a("h5",{staticClass:"bill-title"},[e._v("水费")]),e._l(e.billdata.water,function(e,t){return a("el-table",{attrs:{data:e}},[a("el-table-column",{attrs:{prop:"current",label:"本次记录"}}),a("el-table-column",{attrs:{prop:"lastrecord",label:"末次记录"}}),a("el-table-column",{attrs:{prop:"usage",label:"度差"}}),a("el-table-column",{attrs:{prop:"price",label:"单价"}}),a("el-table-column",{attrs:{prop:"total",label:"价格"}})],1)})],2),a("el-table",{attrs:{"show-summary":"",data:e.billdata.chargeitems}},[a("el-table-column",{attrs:{prop:"name",label:"款项"}}),a("el-table-column",{attrs:{prop:"price",label:"价格"}})],1),a("div",{staticClass:"link-btn-wrap"},[a("a",{staticClass:"link-button",attrs:{href:"mprint://myprint.ciwi/easyhome?"+e.billdata.print}},[e._v("打印")])])],1)},Fe=[],Ke=(a("c5f6"),{name:"Bill",props:["initdata"],data:function(){return{}},computed:{billdata:function(){var e={eletric:[],water:[],chargeitems:[],print:""},t="";this.initdata.chargeitems.forEach(function(e){t=t+"&"+e.name+"="+e.price});var a,i=0,r=0,n=0;this.initdata.eletric.forEach(function(e){r+=Number(e.lastrecord),n+=Number(e.current),e.usage=e.current-e.lastrecord,e.total=(e.usage*e.price).toFixed(2),a=e.price,i+=Ge()(e.total)});var o="&ef=l"+r+"c"+n+"p"+a;e.eletric=this.initdata.eletric.map(function(e){return[e]}),e.chargeitems.push({name:"电费",price:i});var s=0;r=0,n=0,a=0,this.initdata.water.forEach(function(e){r+=Number(e.lastrecord),n+=Number(e.current),e.usage=e.current-e.lastrecord,e.total=(e.usage*e.price).toFixed(2),a=e.price,s+=Ge()(e.total)});var l="wf=l"+r+"c"+n+"p"+a;return e.water=this.initdata.water.map(function(e){return[e]}),e.chargeitems.push({name:"水费",price:s}),this.initdata.chargeitems.forEach(function(t){e.chargeitems.push(t)}),e.print=l+o+t+"&number="+this.initdata.number,e}}}),Je=Ke,Ye=(a("7bd9"),Object(k["a"])(Je,We,Fe,!1,null,"24d1a2e4",null)),Ve=Ye.exports,Xe={name:"generatebill",components:{Mnavbar:ze,Mbill:Ve},data:function(){return{navdata:[{label:"抄表",key:"addnew"},{label:"历史记录",key:"history"}],house:{},eletricmonitors:[],watermonitors:[],chargeitems:{},print:"",billon:!1,addnew:!0,history:!1,active:"addnew",historybills:[],historybill:"",historydata:{eletric:[],water:[],chargeitems:[]},mcookie:{}}},beforeRouteEnter:function(e,t,a){a(function(e){})},computed:{bill:function(){var e=this,t={eletric:[],water:[],chargeitems:[{name:"租金",price:this.house.price?this.house.price:0},{name:"电费",price:0},{name:"水费",price:0}]};return this.eletricmonitors.length>0&&(this.eletricmonitors.forEach(function(e){e.usage=e.current-e.lastrecord,e.total=(e.usage*e.price).toFixed(2),t.chargeitems[1].price+=Ge()(e.total)}),t.eletric=this.eletricmonitors.map(function(e){var t=[e];return t})),this.watermonitors.length>0&&(this.watermonitors.forEach(function(e){e.usage=e.current-e.lastrecord,e.total=(e.usage*e.price).toFixed(2),t.chargeitems[2].price+=Ge()(e.total)}),t.water=this.watermonitors.map(function(e){var t=[e];return t})),this.house.chargeitems&&this.house.chargeitems.forEach(function(a){t.chargeitems.push(e.chargeitems[a])}),t}},created:function(){this.mcookie=w.parseCookie();var e=this,t=this.getChargeitems(),a=new He.a(function(t,a){window.firebase.database().ref("houses/"+e.$route.params.id).once("value").then(function(a){e.house=a.val(),t()})});He.a.all([a,t]).then(function(){e.getMonitors()})},methods:{getMonitors:function(){this.house.eletric&&this.getRecorddata("eletric"),this.house.water&&this.getRecorddata("water")},getChargeitems:function(){var e=this,t=new He.a(function(t,a){window.firebase.database().ref("chargeitems").once("value",function(a){e.chargeitems=a.val(),t()})});return t},getRecorddata:function(e){var t=this,a=this,i={eletric:{tname:"eletricmonitors",hmonitors:this.house.eletricmonitors},water:{tname:"watermonitors",hmonitors:this.house.watermonitors}},r=[],n=f()(),o=i[e].hmonitors.map(function(t){var n=new He.a(function(n,o){var s={current:""},l=new He.a(function(a,r){window.firebase.database().ref(i[e].tname+"/"+t).once("value",function(e){var t=b()(e.val().records).map(function(t){return e.val().records[t]});w.quicksort(t),s.name=e.val().name,s.lastrecord=t[t.length-1].value,s.lastdate=w.getDate(t[t.length-1].date),s.records=t,a()})}),c=new He.a(function(r,n){window.firebase.database().ref(i[e].tname+"/"+t+"/priceid").once("value",function(e){s.id=t,a.mcookie[s.id]&&(s.current=a.mcookie[s.id]),s.price=a.chargeitems[e.val()].price,r()})});He.a.all([l,c]).then(function(){r.push(s),n()})});return n});He.a.all(o).then(function(){"water"==e?t.watermonitors=r:t.eletricmonitors=r,console.log(f()()-n)})},addrecord:function(){this.eletricmonitors.forEach(function(e){var t=window.firebase.database().ref("eletricmonitors/"+e.id+"/records").push();t.set({value:e.current,date:f()().valueOf()})}),this.watermonitors.forEach(function(e){var t=window.firebase.database().ref("watermonitors/"+e.id+"/records").push();t.set({value:e.current,date:f()().valueOf()})})},generate:function(){var e=this,t=this;t.historydata.eletric=[],t.historydata.water=[],t.historydata.chargeitems=[],this.eletricmonitors.forEach(function(e){t.historydata.eletric.push({lastrecord:e.lastrecord,current:e.current,price:e.price})}),this.watermonitors.forEach(function(e){t.historydata.water.push({lastrecord:e.lastrecord,current:e.current,price:e.price})}),this.house.chargeitems.forEach(function(a){t.historydata.chargeitems.push(e.chargeitems[a])}),t.historydata.chargeitems.push({name:"租金",price:this.house.price}),this.addrecord(),t.historydata.number=this.house.number,this.billon=!0},handleSelect:function(e){this[this.active]=!1,this[e]=!0,this.active=e;this.billon=!1,"history"==this.active&&(this.eletricmonitors[0].records.forEach(function(e){e.label=w.getDate(e.date)}),this.historybills=this.eletricmonitors[0].records.slice(1))},handlebillselect:function(e){var t=this,a=this;a.historydata.number=this.house.number,a.historydata.eletric=[],a.historydata.water=[],0==this.historydata.chargeitems.length&&(this.house.chargeitems.forEach(function(e){a.historydata.chargeitems.push(t.chargeitems[e])}),a.historydata.chargeitems.push({name:"租金",price:this.house.price})),this.eletricmonitors.forEach(function(t){a.historydata.eletric.push({lastrecord:t.records[e].value,current:t.records[e+1].value,price:t.price})}),this.watermonitors.forEach(function(t){a.historydata.water.push({lastrecord:t.records[e].value,current:t.records[e+1].value,price:t.price})}),this.billon=!0},handleChange:function(){var e=new Date(f()()+6048e5);this.eletricmonitors.forEach(function(t){document.cookie=t.id+"="+t.current+";expires="+e.toGMTString()}),this.watermonitors.forEach(function(t){document.cookie=t.id+"="+t.current+";expires="+e.toGMTString()})}}},et=Xe,tt=(a("b0f7"),Object(k["a"])(et,qe,Ze,!1,null,"e7ad8aa4",null)),at=tt.exports,it=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""},on:{"row-click":e.handleRowclick}},[a("el-table-column",{attrs:{prop:"number",label:"房号",width:"80"}}),a("el-table-column",{attrs:{prop:"address",label:"地址",width:"min-width"}})],1)],1)},rt=[],nt=a("f499"),ot=a.n(nt),st={name:"Queryrecords",data:function(){return{tableData:[]}},created:function(){var e=this;window.firebase.database().ref("houses").once("value",function(t){e.tableData=w.Object2Array(t.val())})},methods:{handleRowclick:function(e){this.$router.push({path:"/managerecord/"+ot()(e.eletricmonitors)})}}},lt=st,ct=Object(k["a"])(lt,it,rt,!1,null,"f8ea8b6e",null),ut=ct.exports,dt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"info-title"},[a("strong",[e._v(e._s(e.$store.state.house.number+"   "+e.$store.state.house.address))])]),a("div",{staticClass:"houses-head-wrap"},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#409EFE","active-value":"watermonitors","inactive-value":"eletricmonitors","active-text":"水表记录","inactive-text":"电表记录"},on:{change:e.handleTypeswitch},model:{value:e.monitortype,callback:function(t){e.monitortype=t},expression:"monitortype"}}),a("div",{staticStyle:{"flex-grow":"1"}}),a("el-button",{attrs:{type:"primary",size:"small",round:""},on:{click:e.handleToAdd}},[e._v("添加")])],1),e._l(e.tableData,function(t,i){return a("div",{staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"monitor-title"},[e._v(e._s("eletricmonitors"==e.monitortype?"电表"+t.name:"水表"+t.name))]),a("el-table",{attrs:{data:t.records}},[a("el-table-column",{attrs:{prop:"value",label:"数值",width:"80"}}),a("el-table-column",{attrs:{prop:"dateformate",label:"日期",width:"min-width"}}),a("el-table-column",{attrs:{label:"操作",width:"min-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1)],1)})],2)},mt=[],ht={name:"Managerecord",data:function(){return{tableData:[],monitortype:"",eletricwatched:!1,waterwatched:!1,pagetitle:"水电表记录"}},beforeRouteEnter:function(e,t,a){a(function(e){e.$store.commit("settitle",e.pagetitle)})},created:function(){this.monitortype=this.$store.state.monitortype,this.init()},methods:{init:function(){var e=this,t=f()(),a=this;He.a.all(this.getRecords()).then(function(){console.log(f()()-t),"eletricmonitors"===e.monitortype&&!a.eletricwatched&&(a.watchRecords(),a.eletricwatched=!0),"watermonitors"===e.monitortype&&!a.waterwatched&&(a.watchRecords(),a.waterwatched=!0)})},watchRecords:function(){var e=this,t=this;this.$store.state[this.monitortype].map(function(a){return window.firebase.database().ref(e.monitortype+"/"+a).on("value",function(e){var i={name:e.val().name,id:a,records:w.Object2Array(e.val().records,a)};t.tableData=t.tableData.map(function(e){return e.name===i.name?i:e})})})},getRecords:function(){var e=this,t=this;return this.$store.state[this.monitortype].map(function(a){return window.firebase.database().ref(e.monitortype+"/"+a).once("value",function(e){console.log("k");var i={name:e.val().name,id:a,records:w.Object2Array(e.val().records,a)};t.tableData.push(i)})})},handleEdit:function(e){console.log(e),this.$store.commit("setclickeditem",e),this.$router.push({path:"editrecord"})},handleDelete:function(e){var t=this;this.$confirm("删除 ".concat(e.value," - ").concat(e.dateformate," 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){window.firebase.database().ref(t.monitortype+"/"+e.parentid+"/records/"+e.id).remove(),t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleTypeswitch:function(){this.tableData=[],this.$store.commit("setmonitortype",this.monitortype),this.init()},handleToAdd:function(){this.$store.commit("setmonitordetail",this.tableData),this.$router.push({path:"/addrecord"})}}},ft=ht,pt=(a("78d2"),Object(k["a"])(ft,dt,mt,!1,null,"3492ec71",null)),bt=pt.exports,vt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-wrap"},[a("el-form",{attrs:{"label-width":"70px",model:e.record,"label-position":"top"}},[a("el-select",{attrs:{placeholder:"请选择电表"},model:{value:e.monitorid,callback:function(t){e.monitorid=t},expression:"monitorid"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),a("el-form-item",{attrs:{label:"数值"}},[a("el-input",{model:{value:e.record.value,callback:function(t){e.$set(e.record,"value",t)},expression:"record.value"}})],1),a("el-form-item",{attrs:{label:"日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.record.date,callback:function(t){e.$set(e.record,"date",t)},expression:"record.date"}})],1)],1),a("div",{staticClass:"btn-wrap"},[a("el-button",{attrs:{type:"primary",size:"small",round:""},on:{click:e.handleToAdd}},[e._v("保存")])],1)],1)},wt=[],gt={name:"Addrecord",data:function(){return{record:{value:"",date:""},monitorid:"",options:[],pagetitle:"新增水电表记录"}},beforeRouteEnter:function(e,t,a){a(function(e){e.$store.commit("settitle",e.pagetitle)})},created:function(){console.log(this.$store.state.monitordetail),this.initOptions()},methods:{handleToAdd:function(){var e=window.firebase.database().ref(this.$store.state.monitortype+"/"+this.monitorid+"/records").push();e.set({value:this.record.value,date:this.record.date.valueOf()}),this.$router.push({path:"/managerecord"})},initOptions:function(){var e={eletricmonitors:"电表",watermonitors:"水表"},t=this;this.$store.state.monitordetail.forEach(function(a){t.options.push({name:e[t.$store.state.monitortype]+a.name,id:a.id})})}}},yt=gt,kt=(a("9d19"),Object(k["a"])(yt,vt,wt,!1,null,"03f210a3",null)),$t=kt.exports,xt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-wrap"},[a("el-form",{attrs:{"label-width":"70px",model:e.record,"label-position":"top"}},[a("el-form-item",{attrs:{label:"数值"}},[a("el-input",{model:{value:e.record.value,callback:function(t){e.$set(e.record,"value",t)},expression:"record.value"}})],1),a("el-form-item",{attrs:{label:"日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.record.date,callback:function(t){e.$set(e.record,"date",t)},expression:"record.date"}})],1)],1),a("div",{staticClass:"btn-wrap"},[a("el-button",{attrs:{type:"primary",size:"small",round:""},on:{click:e.handleToAdd}},[e._v("保存")])],1)],1)},_t=[],Lt={name:"editrecord",data:function(){return{record:{value:"",date:""},pagetitle:"修改水电表记录"}},beforeRouteEnter:function(e,t,a){a(function(e){e.$store.commit("settitle",e.pagetitle)})},created:function(){this.record.value=this.$store.state.clickeditem.value,this.record.date=new Date(this.$store.state.clickeditem.date)},methods:{handleToAdd:function(){window.firebase.database().ref(this.$store.state.monitortype+"/"+this.$store.state.clickeditem.parentid+"/records/"+this.$store.state.clickeditem.id).set({value:this.record.value,date:this.record.date.valueOf()}),this.$router.push({path:"/managerecord"})}}},Qt=Lt,Ct=(a("8ca9"),Object(k["a"])(Qt,xt,_t,!1,null,"32c92946",null)),Et=Ct.exports,Dt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("svg",{attrs:{version:"1.1",preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"-272.610 0.000 1545.220 1000.000"}},[a("defs",[a("path",{attrs:{d:"M182.441,341.221 C182.441,222.136,222.136,182.441,341.221,182.441 L658.779,182.441 C777.864,182.441,817.559,222.136,817.559,341.221 L817.559,658.779 C817.559,777.864,777.864,817.559,658.779,817.559 L341.221,817.559 C222.136,817.559,182.441,777.864,182.441,658.779 Z","stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":"25",id:"def-b1586869-9ed6-4d49-94f4-f8392985d00f"}}),a("g",{attrs:{id:"def-ea45a2f7-86ab-4a5a-81c4-94d8802095a6"}},[a("path",{attrs:{d:"M220.887,500.000 A279.113,279.113 0 1 0 779.113,500.000 A279.113,279.113 0 1 0 220.887,500.000 Z M765.780,500.000 A265.780,265.780 0 1 1 234.220,500.000 A265.780,265.780 0 1 1 765.780,500.000 Z M256.071,500.000 A243.929,243.929 0 1 0 743.929,500.000 A243.929,243.929 0 1 0 256.071,500.000 Z",fill:"#fff"}}),a("use",{attrs:{"xlink:href":"#def-beb85b84-1ff1-4418-9b5d-ab22ac44ed33"}})]),a("path",{attrs:{d:"M357.572,499.706 Q350.478,499.706,350.478,495.923 L350.478,495.923 L350.478,421.438 Q350.478,418.955,351.601,417.832 Q352.725,416.709,355.207,416.709 L355.207,416.709 L378.262,416.709 Q407.701,416.709,407.701,438.936 L407.701,438.936 Q407.701,445.557,403.977,450.464 Q400.253,455.370,393.868,457.735 L393.868,457.735 L393.868,458.208 Q396.115,459.035,398.479,462.168 Q400.844,465.301,402.381,469.085 L402.381,469.085 L412.785,495.095 Q413.376,496.632,413.376,497.342 L413.376,497.342 Q413.376,498.406,411.603,499.056 Q409.829,499.706,406.283,499.706 L406.283,499.706 L401.435,499.706 Q395.642,499.706,394.578,497.223 L394.578,497.223 L385.238,474.169 Q383.228,470.267,380.922,468.671 Q378.617,467.075,373.296,467.075 L373.296,467.075 L368.686,467.075 L368.686,495.923 Q368.686,499.706,361.592,499.706 L361.592,499.706 L357.572,499.706 Z M368.686,451.350 L379.917,451.350 Q383.582,451.350,386.302,448.395 Q389.021,445.439,389.021,441.183 L389.021,441.183 Q389.021,437.045,386.361,434.621 Q383.701,432.197,379.090,432.197 L379.090,432.197 L368.686,432.197 L368.686,451.350 Z M435.341,499.470 Q432.858,499.470,431.735,498.347 Q430.612,497.223,430.612,494.741 L430.612,494.741 L430.612,421.438 Q430.612,418.955,431.735,417.832 Q432.858,416.709,435.341,416.709 L435.341,416.709 L476.840,416.709 Q478.732,416.709,479.559,418.128 Q480.387,419.546,480.387,422.620 L480.387,422.620 L480.387,426.286 Q480.387,429.360,479.559,430.778 Q478.732,432.197,476.840,432.197 L476.840,432.197 L448.819,432.197 L448.819,449.340 L473.648,449.340 Q475.539,449.340,476.367,450.759 Q477.195,452.178,477.195,455.252 L477.195,455.252 L477.195,458.917 Q477.195,461.991,476.367,463.410 Q475.539,464.829,473.648,464.829 L473.648,464.829 L448.819,464.829 L448.819,483.982 L476.958,483.982 Q478.850,483.982,479.677,485.400 Q480.505,486.819,480.505,489.893 L480.505,489.893 L480.505,493.558 Q480.505,496.632,479.677,498.051 Q478.850,499.470,476.958,499.470 L476.958,499.470 L435.341,499.470 Z M508.618,499.706 Q501.524,499.706,501.524,495.923 L501.524,495.923 L501.524,420.256 Q501.524,416.473,508.618,416.473 L508.618,416.473 L513.702,416.473 Q516.539,416.473,518.431,417.123 Q520.323,417.773,521.505,419.665 L521.505,419.665 L548.107,460.690 Q550.471,464.119,552.363,467.666 L552.363,467.666 L552.836,467.548 Q552.599,464.829,552.599,459.508 L552.599,459.508 L552.599,420.256 Q552.599,416.473,559.693,416.473 L559.693,416.473 L563.122,416.473 Q570.216,416.473,570.216,420.256 L570.216,420.256 L570.216,495.923 Q570.216,499.706,563.122,499.706 L563.122,499.706 L558.629,499.706 Q555.792,499.706,553.900,499.056 Q552.008,498.406,550.826,496.514 L550.826,496.514 L523.633,454.897 Q521.268,451.469,519.377,447.922 L519.377,447.922 L518.904,448.040 Q519.140,450.759,519.140,456.079 L519.140,456.079 L519.140,495.923 Q519.140,499.706,512.046,499.706 L512.046,499.706 L508.618,499.706 Z M615.945,499.706 Q608.851,499.706,608.851,495.923 L608.851,495.923 L608.851,432.197 L590.052,432.197 Q588.161,432.197,587.333,430.778 Q586.505,429.360,586.505,426.286 L586.505,426.286 L586.505,422.620 Q586.505,419.546,587.333,418.128 Q588.161,416.709,590.052,416.709 L590.052,416.709 L645.975,416.709 Q647.867,416.709,648.694,418.128 Q649.522,419.546,649.522,422.620 L649.522,422.620 L649.522,426.286 Q649.522,429.360,648.694,430.778 Q647.867,432.197,645.975,432.197 L645.975,432.197 L627.176,432.197 L627.176,495.923 Q627.176,499.706,620.083,499.706 L620.083,499.706 L615.945,499.706 Z M355.848,582.992 Q350.478,582.992,350.478,580.128 L350.478,580.128 L350.478,522.845 Q350.478,519.981,355.848,519.981 L355.848,519.981 L358.981,519.981 Q364.351,519.981,364.351,522.845 L364.351,522.845 L364.351,544.953 L388.517,544.953 L388.517,522.845 Q388.517,519.981,393.888,519.981 L393.888,519.981 L397.020,519.981 Q402.390,519.981,402.390,522.845 L402.390,522.845 L402.390,580.128 Q402.390,582.992,397.020,582.992 L397.020,582.992 L393.888,582.992 Q388.517,582.992,388.517,580.128 L388.517,580.128 L388.517,556.767 L364.351,556.767 L364.351,580.128 Q364.351,582.992,358.981,582.992 L358.981,582.992 L355.848,582.992 Z M447.481,583.529 Q433.608,583.529,426.179,575.250 Q418.750,566.971,418.750,551.486 L418.750,551.486 Q418.750,536.002,426.179,527.723 Q433.608,519.444,447.481,519.444 L447.481,519.444 Q461.354,519.444,468.738,527.723 Q476.122,536.002,476.122,551.486 L476.122,551.486 Q476.122,566.971,468.738,575.250 Q461.354,583.529,447.481,583.529 L447.481,583.529 Z M447.481,571.804 Q454.641,571.804,458.311,566.613 Q461.980,561.421,461.980,551.486 L461.980,551.486 Q461.980,541.551,458.311,536.405 Q454.641,531.259,447.481,531.259 L447.481,531.259 Q440.320,531.259,436.606,536.405 Q432.892,541.551,432.892,551.486 L432.892,551.486 Q432.892,561.421,436.606,566.613 Q440.320,571.804,447.481,571.804 L447.481,571.804 Z M517.453,583.529 Q505.102,583.529,498.299,577.845 Q491.497,572.162,491.497,561.869 L491.497,561.869 L491.497,522.845 Q491.497,519.981,496.867,519.981 L496.867,519.981 L499.911,519.981 Q505.281,519.981,505.281,522.845 L505.281,522.845 L505.281,560.974 Q505.281,565.718,508.682,568.761 Q512.083,571.804,517.453,571.804 L517.453,571.804 Q522.824,571.804,526.269,568.761 Q529.715,565.718,529.715,560.974 L529.715,560.974 L529.715,522.845 Q529.715,519.981,535.086,519.981 L535.086,519.981 L538.039,519.981 Q543.409,519.981,543.409,522.845 L543.409,522.845 L543.409,561.869 Q543.409,572.162,536.607,577.845 Q529.805,583.529,517.453,583.529 L517.453,583.529 Z M577.759,583.529 Q571.405,583.529,566.661,582.276 Q561.917,581.023,559.232,579.054 L559.232,579.054 Q556.726,577.353,556.726,575.652 L556.726,575.652 Q556.726,574.310,557.710,572.430 Q558.695,570.551,560.038,569.119 Q561.380,567.687,562.275,567.687 L562.275,567.687 Q562.812,567.687,564.781,568.761 L564.781,568.761 Q567.645,570.193,569.972,570.998 Q572.300,571.804,575.432,571.804 L575.432,571.804 Q578.923,571.804,581.384,570.416 Q583.846,569.029,583.846,565.539 L583.846,565.539 Q583.846,562.674,581.563,561.019 Q579.281,559.363,574.179,557.304 L574.179,557.304 L570.062,555.514 Q564.423,552.829,561.201,548.846 Q557.979,544.863,557.979,537.524 L557.979,537.524 Q557.979,531.438,560.977,527.365 Q563.976,523.293,568.809,521.368 Q573.642,519.444,579.191,519.444 L579.191,519.444 Q583.756,519.444,587.471,520.384 Q591.185,521.324,593.333,522.845 L593.333,522.845 Q595.302,524.277,595.302,525.709 L595.302,525.709 Q595.302,526.962,594.497,528.842 Q593.691,530.721,592.527,532.109 Q591.364,533.496,590.379,533.496 L590.379,533.496 Q589.932,533.496,588.903,533.049 Q587.873,532.601,587.157,532.333 L587.157,532.333 Q583.935,531.259,580.444,531.259 L580.444,531.259 Q575.790,531.259,573.955,532.780 Q572.121,534.302,572.121,536.271 L572.121,536.271 Q572.121,538.598,573.374,540.119 Q574.627,541.641,576.417,542.581 Q578.207,543.521,581.697,545.042 L581.697,545.042 Q586.799,547.190,590.021,549.115 Q593.244,551.039,595.615,554.664 Q597.987,558.289,597.987,563.927 L597.987,563.927 Q597.987,570.819,595.078,575.205 Q592.169,579.591,587.605,581.560 Q583.040,583.529,577.759,583.529 L577.759,583.529 Z M615.331,582.813 Q613.452,582.813,612.602,581.962 Q611.751,581.112,611.751,579.233 L611.751,579.233 L611.751,523.740 Q611.751,521.861,612.602,521.010 Q613.452,520.160,615.331,520.160 L615.331,520.160 L646.747,520.160 Q648.179,520.160,648.806,521.234 Q649.432,522.308,649.432,524.635 L649.432,524.635 L649.432,527.410 Q649.432,529.737,648.806,530.811 Q648.179,531.885,646.747,531.885 L646.747,531.885 L625.535,531.885 L625.535,544.863 L644.331,544.863 Q645.763,544.863,646.389,545.937 Q647.016,547.011,647.016,549.338 L647.016,549.338 L647.016,552.113 Q647.016,554.440,646.389,555.514 Q645.763,556.588,644.331,556.588 L644.331,556.588 L625.535,556.588 L625.535,571.088 L646.837,571.088 Q648.269,571.088,648.895,572.162 Q649.522,573.236,649.522,575.563 L649.522,575.563 L649.522,578.338 Q649.522,580.665,648.895,581.739 Q648.269,582.813,646.837,582.813 L646.837,582.813 L615.331,582.813 Z",fill:"#000",id:"def-beb85b84-1ff1-4418-9b5d-ab22ac44ed33"}}),a("g",{attrs:{id:"def-e94ef11a-3efb-4e7a-9987-a8cf0392d627"}},[a("use",{attrs:{"xlink:href":"#def-b1586869-9ed6-4d49-94f4-f8392985d00f","stroke-width":"0.000"}})]),a("mask",{attrs:{id:"mask-7aaf699b-2dee-44f9-9278-541dbb6d2215",x:"80.822",y:"80.822",width:"838.355",height:"838.355",maskUnits:"userSpaceOnUse","stroke-width":"0"}},[a("rect",{attrs:{x:"118.929",y:"118.929",width:"762.141",height:"762.141",fill:"#000"}}),a("use",{attrs:{"xlink:href":"#def-e94ef11a-3efb-4e7a-9987-a8cf0392d627",fill:"#fff",stroke:"#fff"}})]),a("mask",{attrs:{id:"mask-bfda327e-f836-49ef-859f-a45d2aa505e9",x:"131.570",y:"131.154",width:"736.859",height:"737.692",maskUnits:"userSpaceOnUse","stroke-width":"0"}},[a("rect",{attrs:{x:"165.064",y:"164.648",width:"669.872",height:"670.705",fill:"#000"}}),a("use",{attrs:{"xlink:href":"#def-ea45a2f7-86ab-4a5a-81c4-94d8802095a6",fill:"#fff",stroke:"#fff"}})])]),a("rect",{attrs:{id:"background-shape-8775728c-0543-4970-9193-a695196e6b82",x:"-272.610",y:"0.000",width:"1545.220",height:"1000.000",fill:"#fffcf6"}}),a("g",{attrs:{mask:"url(#mask-7aaf699b-2dee-44f9-9278-541dbb6d2215)"}},[a("rect",{attrs:{x:"118.929",y:"118.929",width:"762.141",height:"762.141",fill:"#a37bff"}}),a("g",{attrs:{mask:"url(#mask-bfda327e-f836-49ef-859f-a45d2aa505e9)"}},[a("rect",{attrs:{x:"165.064",y:"164.648",width:"669.872",height:"670.705",fill:"#ffffff"}})])])]),a("el-form",{attrs:{model:e.formdata,"label-width":"80px","label-position":"top"}},[a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{model:{value:e.formdata.username,callback:function(t){e.$set(e.formdata,"username",t)},expression:"formdata.username"}})],1),a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{type:"password"},model:{value:e.formdata.password,callback:function(t){e.$set(e.formdata,"password",t)},expression:"formdata.password"}})],1),a("div",{staticClass:"button-wrap"},[a("el-button",{attrs:{type:"primary",round:""},on:{click:e.handleSignin}},[e._v("登录")])],1)],1)],1)},St=[],Ot={name:"Signin",data:function(){return{formdata:{username:"",password:""}}},methods:{handleSignin:function(){window.loading=this.$loading();var e=this;window.firebase.auth().setPersistence(firebase.auth.Auth.Persistence.SESSION).then(function(){return window.firebase.auth().signInWithEmailAndPassword(e.formdata.username,e.formdata.password).catch(function(e){var t=e.code,a=e.message;"auth/wrong-password"===t?alert("Wrong password."):alert(a),loading.close()})})}}},At=Ot,Rt=(a("7520"),Object(k["a"])(At,Dt,St,!1,null,"56a1c6dc",null)),jt=Rt.exports,Tt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"详细信息",visible:e.showdetail},on:{"update:visible":function(t){e.showdetail=t}}},[a("div",{staticClass:"detail-label"},[a("strong",[e._v("姓名")])]),a("div",{staticClass:"detail"},[e._v(e._s(e.detailData.name))]),a("div",{staticClass:"detail-label"},[a("strong",[e._v("身份证")])]),a("div",{staticClass:"detail"},[e._v(e._s(e.detailData.idnum))]),a("div",{staticClass:"detail-label"},[a("strong",[e._v("联系电话")])]),a("div",{staticClass:"detail"},[e._v(e._s(e.detailData.phonenumber))])]),a("div",{staticClass:"info-title"},[a("strong",[e._v(e._s(e.$store.state.house.number+"   "+e.$store.state.house.address))])]),a("div",{staticClass:"btn-wrap"},[a("el-button",{attrs:{type:"primary",size:"small",round:""},on:{click:e.handleAddleader}},[e._v("添加")])],1),a("ul",{staticClass:"history-list"},[e._m(0),e._l(e.listdata,function(t,i){return a("li",[a("div",{staticClass:"leader-wrap",attrs:{clickitem:t},on:{click:function(a){return e.handleClick(t)}}},[a("div",{staticStyle:{width:"30%"}},[e._v(e._s(t.regisdate))]),a("div",{staticClass:"name-col",staticStyle:{width:"20%"}},[a("span",[e._v(e._s(t.name))]),a("span",{on:{click:function(a){return e.showDetail(a,t)}}},[e._v("详细信息")])]),a("div",{staticStyle:{width:"30%"}},[e._v(e._s(t.leavedate?t.leavedate:"租赁中"))]),a("div",{staticStyle:{width:"20%"}},[a("div",{staticClass:"cbtn-wrap"},[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEditl(a,t)}}},[e._v("编辑")])],1),a("div",{staticClass:"cbtn-wrap"},[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDeleteleader(a,t)}}},[e._v("删除")])],1)])]),a("div",{staticClass:"arrow-bar"},[a("i",{class:{"el-icon-arrow-down":!t.showmembers,"el-icon-arrow-down arrow-on":t.showmembers}})]),a("el-collapse-transition",[t.showmembers?a("div",{staticClass:"members-wrap"},[a("div",{staticClass:"members-title"},[e._v("成员列表")]),e._l(t.members,function(t,i){return a("div",{staticClass:"leader-wrap member-wrap"},[a("div",{staticClass:"member-date",staticStyle:{width:"30%"}},[e._v(e._s(t.regisdate))]),a("div",{staticClass:"member-name-col",staticStyle:{width:"20%"}},[a("span",[e._v(e._s(t.name))]),a("span",{on:{click:function(a){return e.showDetail(a,t)}}},[e._v("详细信息")])]),a("div",{staticClass:"member-date",staticStyle:{width:"30%"}},[e._v(e._s(t.leavedate?t.leavedate:"居住中"))]),a("div",{staticStyle:{width:"20%"}},[a("div",{staticClass:"mbtn-wrap"},[a("span",{on:{click:function(a){return e.handleEdit(a,t)}}},[e._v("编辑")])]),a("div",{staticClass:"mbtn-wrap"},[a("span",{on:{click:function(a){return e.handleDelete(t)}}},[e._v("删除")])])])])}),a("div",{staticClass:"btn-wrap"},[a("el-button",{attrs:{type:"primary",size:"small",round:""},on:{click:function(a){return e.handleAddmember(t.idnum)}}},[e._v("添加成员")])],1)],2):e._e()])],1)})],2)],1)},zt=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("li",{staticClass:"label-bar"},[a("div",{staticStyle:{width:"30%"}},[e._v("入住日期")]),a("div",{staticStyle:{width:"20%"}},[e._v("姓名")]),a("div",{staticStyle:{width:"30%"}},[e._v("离开日期")]),a("div",{staticStyle:{width:"20%"}},[e._v("操作")])])}],Mt={name:"History",data:function(){return{aon:!1,listdata:[],detailData:{},showdetail:!1}},created:function(){var e=this;window.firebase.database().ref("renthistory/"+this.$store.state.house.id+"/leaders").on("value",function(t){var a=[];t.forEach(function(e){console.log(e.val());var t=e.val();t.id=e.key,t.regisdate=w.getDate(e.val().regisdate),t.showmembers=!1,t.leavedate&&(t.leavedate=w.getDate(t.leavedate)),t.members=[],a.push(t)}),e.listdata=a})},methods:{handleClick:function(e){console.log(e),e.showmembers=!e.showmembers,0==e.members.length&&window.firebase.database().ref("renthistory/"+this.$store.state.house.id+"/members").orderByChild("leader").equalTo(e.idnum).on("value",function(t){var a=[];t.forEach(function(e){var t=e.val();t.id=e.key,t.regisdate=w.getDate(e.val().regisdate),e.val().leavedate&&(t.leavedate=w.getDate(e.val().leavedate)),console.log(t.leavedate),a.push(t)}),e.members=a})},handleSubClick:function(e,t){console.log(arguments),e.stopPropagation(),console.log(t)},handleEdit:function(e,t){e.stopPropagation(),console.log(t),this.$store.commit("setcustomertype","members"),this.$store.commit("setcustomer",t.id),this.$router.push({path:"/editcustomer"})},handleEditl:function(e,t){e.stopPropagation(),console.log(t),this.$store.commit("setcustomertype","leaders"),this.$store.commit("setcustomer",t.id),this.$router.push({path:"/editcustomer"})},showDetail:function(e,t){console.log(arguments),e.stopPropagation(),console.log(t),this.showdetail=!0,this.detailData=t},handleDelete:function(e){var t=this;console.log(e),this.$confirm("删除 ".concat(e.name," 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){window.firebase.database().ref("renthistory/"+t.$store.state.house.id+"/members/"+e.id).remove(),t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleDeleteleader:function(e,t){var a=this;e.stopPropagation(),console.log(t),this.$confirm("删除 ".concat(t.name," 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){window.firebase.database().ref("renthistory/"+a.$store.state.house.id+"/leaders/"+t.id).remove(),a.$message({type:"success",message:"删除成功!"})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleAddleader:function(){this.$store.commit("setcustomertype","leader"),this.$router.push({path:"addcustomer"})},handleAddmember:function(e){this.$store.commit("setleader",e),this.$store.commit("setcustomertype","member"),this.$router.push({path:"addcustomer"})}}},Nt=Mt,Pt=(a("e723"),Object(k["a"])(Nt,Tt,zt,!1,null,"f1ac46d8",null)),Bt=Pt.exports,qt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-form"},[a("el-form",{attrs:{model:e.formdata,"label-width":"80px","label-position":"top"}},[a("el-form-item",{attrs:{label:"入住日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.formdata.regisdate,callback:function(t){e.$set(e.formdata,"regisdate",t)},expression:"formdata.regisdate"}})],1),a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{model:{value:e.formdata.name,callback:function(t){e.$set(e.formdata,"name",t)},expression:"formdata.name"}})],1),a("el-form-item",{attrs:{label:"身份证号码"}},[a("el-input",{model:{value:e.formdata.idnum,callback:function(t){e.$set(e.formdata,"idnum",t)},expression:"formdata.idnum"}})],1),a("el-form-item",{attrs:{label:"联系电话"}},[a("el-input",{model:{value:e.formdata.phonenumber,callback:function(t){e.$set(e.formdata,"phonenumber",t)},expression:"formdata.phonenumber"}})],1)],1),a("div",{staticClass:"btn-wrap"},[a("el-button",{attrs:{size:"small",round:"",type:"primary"},on:{click:e.handleAdd}},[e._v("保存")])],1)],1)},Zt=[],Ut={name:"Addcustomer",data:function(){return{formdata:{regisdate:"",name:"",idnum:"",phonenumber:""}}},methods:{handleAdd:function(){if(this.formdata.regisdate=this.formdata.regisdate.valueOf(),"leader"==this.$store.state.customertype){var e=window.firebase.database().ref("renthistory/"+this.$store.state.house.id+"/leaders").push();e.set(this.formdata),window.firebase.database().ref("houses/"+this.$store.state.house.id+"/rentdate").set(this.formdata.regisdate)}else{this.formdata.leader=this.$store.state.leader;var t=window.firebase.database().ref("renthistory/"+this.$store.state.house.id+"/members").push();t.set(this.formdata)}this.$router.push({path:"/history"})}}},Ht=Ut,It=(a("baea"),Object(k["a"])(Ht,qt,Zt,!1,null,"3c5aaaf6",null)),Gt=It.exports,Wt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-form"},[a("el-form",{attrs:{model:e.formdata,"label-width":"80px","label-position":"top"}},[a("el-form-item",{attrs:{label:"入住日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.formdata.regisdate,callback:function(t){e.$set(e.formdata,"regisdate",t)},expression:"formdata.regisdate"}})],1),a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{model:{value:e.formdata.name,callback:function(t){e.$set(e.formdata,"name",t)},expression:"formdata.name"}})],1),a("el-form-item",{attrs:{label:"身份证号码"}},[a("el-input",{model:{value:e.formdata.idnum,callback:function(t){e.$set(e.formdata,"idnum",t)},expression:"formdata.idnum"}})],1),a("el-form-item",{attrs:{label:"联系电话"}},[a("el-input",{model:{value:e.formdata.phonenumber,callback:function(t){e.$set(e.formdata,"phonenumber",t)},expression:"formdata.phonenumber"}})],1),a("el-checkbox",{model:{value:e.checkout,callback:function(t){e.checkout=t},expression:"checkout"}},[e._v("离开登记")]),a("transition",{attrs:{name:"el-zoom-in-top"}},[e.checkout?a("el-form-item",{attrs:{label:"离开日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.leavedate,callback:function(t){e.leavedate=t},expression:"leavedate"}})],1):e._e()],1)],1),a("div",{staticClass:"btn-wrap"},[a("el-button",{attrs:{size:"small",round:"",type:"primary"},on:{click:e.handleAdd}},[e._v("保存")])],1)],1)},Ft=[],Kt={name:"Editcustomer",data:function(){return{formdata:{},checkout:!1,leavedate:""}},created:function(){var e=this;window.firebase.database().ref("renthistory/"+this.$store.state.house.id+"/"+this.$store.state.customertype+"/"+this.$store.state.customer).once("value",function(t){e.formdata=t.val(),e.formdata.leavedate?(e.checkout=!0,e.leavedate=e.formdata.leavedate):e.checkout=!1})},methods:{handleAdd:function(){this.checkout?this.formdata.leavedate=this.leavedate.valueOf():(this.formdata.leavedate=null,"leaders"==this.$store.state.customertype&&window.firebase.database().ref("houses/"+this.$store.state.house.id+"/rentdate").set(this.formdata.regisdate.valueOf())),this.formdata.regisdate=this.formdata.regisdate.valueOf(),window.firebase.database().ref("renthistory/"+this.$store.state.house.id+"/"+this.$store.state.customertype+"/"+this.$store.state.customer).set(this.formdata),this.$router.push({path:"/history"})}}},Jt=Kt,Yt=(a("53cc"),Object(k["a"])(Jt,Wt,Ft,!1,null,"63ff5a02",null)),Vt=Yt.exports,Xt=[{path:"/add",component:R},{path:"/hi",component:x},{path:"/chargeitems",component:P},{path:"/addchargeitem",component:I},{path:"/editchargeitem/:id",component:Y},{path:"/edithouse/:id",component:ie},{path:"/initrecord/:id",component:ce},{path:"/eletric",component:pe},{path:"/water",component:pe},{path:"/addfee",component:$e},{path:"/editfee/:id",component:Ee},{path:"/checkout",component:Be},{path:"/generatebill/:id",component:at},{path:"/queryrecords",component:ut},{path:"/managerecord",component:bt},{path:"/addrecord",component:$t},{path:"/editrecord",component:Et},{path:"/signin",component:jt},{path:"/history",component:Bt},{path:"/addcustomer",component:Gt},{path:"/editcustomer",component:Vt}],ea={state:{house:"",eletricmonitors:"",watermonitors:"",monitortype:"eletricmonitors",monitordetail:"",clickeditem:"",title:"",customertype:"",leadername:"",leader:"",customer:""},mutations:{sethouse:function(e,t){e.house=t},seteletricmonitors:function(e,t){e.eletricmonitors=t},setwatermonitors:function(e,t){e.watermonitors=t},setmonitortype:function(e,t){e.monitortype=t},setmonitordetail:function(e,t){e.monitordetail=t},setclickeditem:function(e,t){e.clickeditem=t},settitle:function(e,t){e.title=t},setcustomertype:function(e,t){e.customertype=t},setleader:function(e,t){e.leader=t},setcustomer:function(e,t){e.customer=t}}};r["default"].use(s["a"]),r["default"].config.productionTip=!1,r["default"].use(o.a),r["default"].use(l["a"]);var ta,aa=new s["a"]({routes:Xt}),ia=new l["a"].Store(ea),ra=document.getElementById("app");window.firebase.auth().onAuthStateChanged(function(e){e?(console.log("success"),ta&&(ra.removeChild(ta.$el),ta.$destroy()),ta=new r["default"]({router:aa,store:ia,render:function(e){return e(C)}}).$mount(),ra.appendChild(ta.$el)):(console.log("signout"),ta&&(ra.removeChild(ta.$el),ta.$destroy()),ta=new r["default"]({render:function(e){return e(jt)}}).$mount(),ra.appendChild(ta.$el))})},"58b7":function(e,t,a){},"5c2e":function(e,t,a){"use strict";var i=a("2c3e"),r=a.n(i);r.a},"64a9":function(e,t,a){},6622:function(e,t,a){},"664a":function(e,t,a){"use strict";var i=a("6622"),r=a.n(i);r.a},6829:function(e,t,a){"use strict";var i=a("36f0"),r=a.n(i);r.a},6938:function(e,t,a){},7520:function(e,t,a){"use strict";var i=a("2fe6"),r=a.n(i);r.a},"78d2":function(e,t,a){"use strict";var i=a("94f8"),r=a.n(i);r.a},"7bd9":function(e,t,a){"use strict";var i=a("4c70"),r=a.n(i);r.a},"873d":function(e,t,a){"use strict";var i=a("8f0e"),r=a.n(i);r.a},8788:function(e,t,a){},"8ca9":function(e,t,a){"use strict";var i=a("58b7"),r=a.n(i);r.a},"8ee3":function(e,t,a){"use strict";var i=a("3c9c"),r=a.n(i);r.a},"8f0e":function(e,t,a){},"94f8":function(e,t,a){},"9d19":function(e,t,a){"use strict";var i=a("424e"),r=a.n(i);r.a},ac6e:function(e,t,a){"use strict";var i=a("6938"),r=a.n(i);r.a},b0f7:function(e,t,a){"use strict";var i=a("51bb"),r=a.n(i);r.a},b23b:function(e,t,a){"use strict";var i=a("c9d5"),r=a.n(i);r.a},b31d:function(e,t,a){"use strict";var i=a("1dc1"),r=a.n(i);r.a},baea:function(e,t,a){"use strict";var i=a("03ab"),r=a.n(i);r.a},c9d5:function(e,t,a){},cd04:function(e,t,a){},d752:function(e,t,a){"use strict";var i=a("8788"),r=a.n(i);r.a},d89c:function(e,t,a){},e723:function(e,t,a){"use strict";var i=a("237f"),r=a.n(i);r.a},fe89:function(e,t,a){}});
//# sourceMappingURL=app.cc7e03b2.js.map